# Adobe Premiere Pro 自动字幕插件

这是一个 Adobe Premiere Pro CEP 扩展插件，利用腾讯云 ASR（语音识别）服务，自动将序列中的音频转换为 SRT 字幕并导入回项目中。

## ✨ 功能特性

*   **一键生成**：自动导出当前序列音频，上传至云端识别。
*   **高精度识别**：基于腾讯云 ASR，支持中文、英文、粤语、日语、韩语等多种语言。
*   **自动对齐**：生成的 SRT 字幕时间码与剪辑序列完美匹配。
*   **高级配置**：支持热词表、数字转换模式、去除标点等高级选项。
*   **安全可靠**：密钥保存在本地，支持直接跳转腾讯云控制台管理资源。

## 📥 下载与安装

### 方式一：普通用户 

1.  前往本项目的 [**Releases (发布页)**](https://github.com/ltzu929/PR-Auto-Subtitles/releases) 。
2.  下载最新的 `PR-Auto-Subtitles.zip` 压缩包。
3.  解压后，将整个文件夹复制到 Adobe 扩展目录：
    *   **Windows:** `C:\Program Files (x86)\Common Files\Adobe\CEP\extensions\`
4.  **重要**：运行注册表脚本开启调试模式（见下文）。

### 方式二：开发者 
如果你想修改代码：

1.  克隆仓库或下载源码。
2.  进入 `server` 目录并安装依赖：
    ```bash
    cd server
    npm install
    ```
3.  放入扩展目录进行调试。

### ⚠️ 开启调试模式 (必须步骤)
由于插件未签名，首次安装必须开启调试模式，否则无法加载。

**Windows:**
1.  按 `Win + R`，输入 `regedit` 打开注册表编辑器。
2.  定位到 `HKEY_CURRENT_USER\Software\Adobe\CSXS.11` (对应 PR 2022+)。
3.  新建字符串值 `PlayerDebugMode`，值为 `1`。

## 📖 使用说明

## 2. 使用方法

1.  **启动 Premiere Pro** 并打开一个项目，确保当前有一个**活动的序列 (Sequence)**。
2.  在顶部菜单栏选择：**窗口 (Window) -> 扩展 (Extensions) -> Auto Subtitles (Tencent)**。
3.  **配置腾讯云信息**：
    *   首次使用需输入 SecretId, SecretKey, Bucket Name 和 Region。
    *   界面提供了快捷链接（如“获取密钥”、“COS控制台”），点击可直接跳转到腾讯云对应页面。
    *   **自动保存**：输入内容或修改设置后，配置会自动保存到本地。
4.  **高级设置 (可选)**：
    *   **引擎模型**：根据视频语言选择（如中文、英语、粤语等）。
    *   **热词表 ID**：如有专有名词识别需求，可在腾讯云控制台创建热词表并填入 ID。
    *   **数字转换**：设置数字的显示格式（阿拉伯数字、中文数字等）。
    *   **去除标点**：勾选后将自动移除字幕中的标点符号（支持中英文标点）。
5.  **开始生成**：
    *   点击“开始生成字幕”。插件将自动导出当前序列的**完整混音**进行识别。
    *   观察下方日志区域，等待进度完成。
    *   完成后，SRT 字幕文件（命名格式：`项目名.srt`）将自动导入到项目素材箱中。
    *   **注意**：生成的字幕时间码从 00:00:00 开始，请将其拖入字幕轨道即可自动对齐。


## 4. 目录结构说明
```text
PR-Auto-Subtitles/
├── CSXS/manifest.xml       # 配置文件
├── client/                 # 前端界面
├── server/                 # 后端逻辑 (含 node_modules)
├── host/                   # PR 交互脚本
├── mp3.epr                 # 音频导出预设
└── .debug                  # 调试端口配置
```
